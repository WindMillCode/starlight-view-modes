<style is:global>
    :is(#view-modes-zen-mode-off, #view-modes-presentation-mode-off) {
        position: fixed;
        width: 3rem;
        height: 3rem;
        
        cursor: pointer;

        padding: 0.5rem;
        background: var(--sl-color-bg);
        border: 2px solid var(--sl-color-gray-1);
        border-radius: 0.5rem;

        color: currentColor;
        box-shadow: 0px 0px none;

        display: flex;
        justify-content: center;
        align-self: center;

        -webkit-transition: color 300ms linear, background-color 300ms linear, box-shadow 300ms linear;
        -ms-transition: color 300ms linear, background-color 300ms linear, box-shadow 300ms linear;
        transition: color 300ms linear, background-color 300ms linear, box-shadow 300ms linear;

        z-index: 1000;
    }

    :is(#view-modes-zen-mode-off, #view-modes-presentation-mode-off):hover {
        background: var(--sl-color-gray-1);
        color: var(--sl-color-gray-6);
        box-shadow: 8px 8px var(--sl-color-gray-4);
    }

    :is(#view-modes-zen-mode-off, #view-modes-presentation-mode-off) > svg {
        transform: translateY(0.1em);
    }

    body:not(.view-modes-zen-mode) :is(#view-modes-zen-mode-off) {
        display: none;
    }

    body:not(.view-modes-presentation-mode) #view-modes-presentation-mode-off {
        display: none;
    }
</style>
  
<script>
    import config from 'virtual:starlight-view-modes-config';
    import { deactivateZenMode, deactivatePresentationMode } from '../libs/SharedMethods';
    import { ZenModePositionStateMachine } from '../libs/ZenModePositionStateMachine';

    document.addEventListener('DOMContentLoaded', () => {
        var body = document.body;

        var zenModeOffElement = document.createElement("a");
        zenModeOffElement.id = "view-modes-zen-mode-off";
        zenModeOffElement.innerHTML = `
            <svg fill="currentColor" height="24" width="24" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
                viewBox="0 0 512 512" xml:space="preserve">
            <g>
                <g>
                    <path d="M256,94.609c-21.478,0-38.957,17.478-38.957,38.957s17.478,38.956,38.957,38.956s38.957-17.478,38.957-38.956
                        C294.957,112.088,277.478,94.609,256,94.609z"/>
                </g>
            </g>
            <g>
                <g>
                    <path d="M256,0C114.843,0,0,114.843,0,256s114.843,256,256,256s256-114.843,256-256S397.157,0,256,0z M256,417.391
                        c-21.478,0-38.957-17.478-38.957-38.957s17.478-38.956,38.957-38.956s38.957,17.478,38.957,38.956
                        C294.957,399.912,277.478,417.391,256,417.391z M256,239.304c-75.185,0-136.348,61.163-136.348,136.348
                        c0,25.278,7.038,48.888,19.074,69.206C75.616,405.521,33.391,335.684,33.391,256c0-122.744,99.865-222.609,222.609-222.609
                        c56.772,0,102.957,46.185,102.957,102.957C358.957,193.12,312.772,239.304,256,239.304z"/>
                </g>
            </g>
            </svg>
        `;        

        var presentationModeOffElement = document.createElement("a");
        presentationModeOffElement.id = "view-modes-presentation-mode-off";
        presentationModeOffElement.innerHTML = `
            <svg width="24" height="24" viewBox="0 0 800 800" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M66.6665 66.6665H630" stroke="currentColor" stroke-width="50" stroke-linecap="round"/>
            <path d="M300 350L343.097 306.903C354.207 295.792 359.763 290.237 366.667 290.237C373.57 290.237 379.127 295.792 390.237 306.903L409.763 326.429C415.768 332.434 429.15 344.74 433 347.5" stroke="currentColor" stroke-width="50" stroke-linecap="round"/>
            <path d="M400 700V566.667" stroke="currentColor" stroke-width="50" stroke-linecap="round"/>
            <path d="M333.333 733.333L400 700" stroke="currentColor" stroke-width="50" stroke-linecap="round"/>
            <path d="M466.667 733.333L400 700" stroke="currentColor" stroke-width="50" stroke-linecap="round"/>
            <mask id="mask0_528_2" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="646" y="172" width="53" height="97">
            <path d="M647.885 215.778C646.281 213.789 646.435 210.911 648.242 209.104L683.723 173.623C686.873 170.473 692.258 172.704 692.258 177.158L692.258 235.961C692.258 236.319 692.297 236.676 692.373 237.026L697.995 262.827C699.118 267.981 692.529 271.136 689.218 267.03L647.885 215.778Z" fill="#D9D9D9"/>
            </mask>
            <g mask="url(#mask0_528_2)">
            <path d="M667.333 67V200.333" stroke="currentColor" stroke-width="50" stroke-linecap="round"/>
            </g>
            <path d="M133.333 66.6665V350C133.333 452.136 133.333 503.206 166.807 534.936C181.595 548.954 200.364 556.779 226 561.147M666.667 333.333V350C666.667 452.136 666.667 503.206 633.193 534.936C599.72 566.666 545.843 566.666 438.097 566.666H361.903C353.803 566.666 346.006 566.666 338.5 566.653" stroke="currentColor" stroke-width="50" stroke-linecap="round"/>
            <path d="M85 715.68L715.68 84.9999" stroke="currentColor" stroke-width="50" stroke-linecap="round"/>
            </svg>
        `;

        body.insertBefore(zenModeOffElement, body.firstChild);
        body.insertBefore(presentationModeOffElement, body.firstChild);

        const zenModeOff = document.getElementById('view-modes-zen-mode-off');
        const presentationModeOff = document.getElementById('view-modes-presentation-mode-off');

        zenModeOff?.addEventListener('click', () => {
            deactivateZenMode();
        });

        presentationModeOff?.addEventListener('click', () => {
            deactivatePresentationMode();
        });

        const zenModePositionStateMachine = new ZenModePositionStateMachine(config, zenModeOff);
        zenModePositionStateMachine.updatePosition();


        // (config.zenModeCloseButtonPosition === 'top-right' || config.zenModeCloseButtonPosition === 'bottom-right') ? zenModeOff?.style.setProperty('right', '1rem') : zenModeOff?.style.setProperty('left', '1rem');
        // (config.zenModeCloseButtonPosition === 'top-right' || config.zenModeCloseButtonPosition === 'top-left') ? zenModeOff?.style.setProperty('top', '1rem') : zenModeOff?.style.setProperty('bottom', '1rem');
    });
</script>
  